---
title: "Project Proposal"
author: "ALL group member names here"
subtitle: "Due November 17 at 11:59pm"
format: pdf
editor: 
  markdown: 
    wrap: 72
---

#### Load Packages

```{r load-packages, message = FALSE, warning = FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(GGally)
library(patchwork)
```

# Dataset 1 (top choice)

**Data source:** County Health Rankings & Roadmaps
https://www.countyhealthrankings.org/health-data/north-carolina/data-and-resources)

Secondary dataset:
https://data.census.gov/table/ACSDT1Y2018.B25103?q=property

**Brief description:** This dataset contains health factor and health
outcome data for each county in NC in 2024. It is provided as part of a
program by the University of Wisconsin Population Health Institute ()
and combines data from other sources, such as the Behavioral Risk Factor
Surveillance System & National Center for Health Statistics.

**Research question 1:** What is the relationship between residential
segregation (continuous variable) and juvenile arrests (continuous
variable)? How is this relationship affected by the region of the US
that the county / state is in (categorical variable called Region)?

-   **Outcome (Dependent) Variable** $Juvenile.Arrest.Rate$

    -   Represents the rate of delinquency cases per 1,000 juveniles in
        a county. This variable quantifies juvenile arrests as a measure
        of youth criminal activity.
    -   **Source**: Data from Juvenile Justice Databases, 2021.

-   **Primary Independent Variable** $Residential.Segregation.Index$

    -   The index of dissimilarity measures residential segregation
        between Black and white residents in a county. Higher values
        indicate greater segregation. This metric captures the extent to
        which these populations reside in separate geographic areas
        within the same county.
    -   **Source:** American Community Survey 5-year estimates,
        2018-2022.

-   **Interaction Term** $Residential.Segregation.Index * Region$

    -   Examines how the relationship between residential segregation
        and juvenile arrests varies by region (`Region` categorical
        variable).

-   **Control Variables** Adjusts for other factors that might confound
    the relationship between segregation and arrests.

    -   $Spending.per.Pupil$ –The average educational expenditure per
        student in a district, which reflects investment in education
        and resources that may impact juvenile arrest rates.

        -   **Source:** State or National Education Finance Databases,
            2021

    -   $School.Funding.Adequacy$ –A continuous measure indicating
        whether school funding meets the needs of the district.
        Inadequate funding may correlate with higher juvenile
        delinquency rates.

        -   **Source:** School Finance Indicators Database, 2021

    -   $School.Segregation.Index$ –A measure of racial or ethnic
        segregation within schools, potentially influencing both
        educational outcomes and juvenile arrest rates.

        -   **Source**: Education Statistics Databases, 2021

    -   $Median.Prop.Tax$ –Median residential property taxes, serving as
        a proxy for socioeconomic conditions and wealth distribution
        within a county.

        -   **Source**: IPUMS, 2018-2022.

**Research question 2:** What is the relationship between residential
segregation (continuous variable), property tax (continuous variable),
and median household income (continuous variable), on school funding
adequacy (categorical variable that we will create)?

-   **Outcome (Dependent) Variable** $School.Funding.Cat$

    -   Categorical variable indicating school funding adequacy. Values:
        "Adequate" or "Inadequate" (derived from
        `School.Funding.Adequacy`).
    -   **Source:** Derived from the School Finance Indicators
        Database, 2021. The adequacy metric reflects the average dollar
        gap between actual and required per-pupil spending needed to
        achieve U.S. average test scores.

-   **Primary Independent Variable:**

    -   $Residential.Segregation.Index$: A continuous variable measuring
        the level of residential segregation between Black and white
        residents in a county. Higher values indicate greater
        segregation.

        -   **Source**: American Community Survey 5-year estimates,
            2018-2022.

    -   $Median.Prop.Tax$ :A continuous variable representing the median
        property tax value in each county. It serves as a proxy for
        socioeconomic resources, as higher property taxes often
        correlate with better-funded schools.

        -   **Source**: Data from IPUMS, 2018-2022.

    -   $Median.Household.Income$ : Median income for households in the
        county (proxy needed if missing; likely not in your dataset).

        -   **Source**: Small Area Income and Poverty Estimates;
            American Community Survey, 5-year estimates, 2018-2022.

-   **Interaction Term** $Residential.Segregation.Index * Region$

    -   Examines how residential segregation’s relationship with school
        funding adequacy varies across regions.
    -   Allows the model to capture region-specific dynamics in the
        influence of segregation on school funding adequacy.

-   **Control Variables**

    -   $Spending.per.Pupil$ –Average spending per student in a
        district.

    -   $School.Segregation.Index$ –A measure of racial/ethnic
        segregation within schools.

**Load the datasets and prepare final dataset\`**:

```{r data-1, warning=FALSE}
alabama_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/Alabama.csv', skip=1)
texas_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/Texas.csv', skip=1)
nc_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/North%20Carolina.csv', skip=1)
colorado_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/Colorado.csv', skip=1)
washington_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/Washington.csv', skip=1)
ny_full <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/New%20York.csv', skip=1)
minnesota_full <-  read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/Minnesota.csv', skip=1)
#colnames(alabama_full)
```

```{r}
desired_cols <- c('FIPS', 'State', 'County', 
"Life.Expectancy", 
"Segregation.Index.1", "X..Limited.Access.to.Healthy.Foods.1", 
"X..Uninsured.Adults.1", 
"Spending.per.Pupil", "School.Funding.Adequacy", 
"Median.Household.Income" 
)

alabama <- alabama_full[desired_cols]
texas <- texas_full[desired_cols]
nc <- nc_full[desired_cols]
ny <- ny_full[desired_cols]
washington <- washington_full[desired_cols]
colorado <- colorado_full[desired_cols]
minnesota <- minnesota_full[desired_cols]
#head(alabama)
```

```{r}

texas <- texas |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

alabama <- alabama |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

nc <- nc |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

ny <- ny |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

washington <- washington |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

colorado <- colorado |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

minnesota <- minnesota |> 
  rename(
    Percent.Uninsured.Adults = X..Uninsured.Adults.1, 
    Percent.Limited.Access.Healthy.Foods = X..Limited.Access.to.Healthy.Foods.1,
    Residential.Segregation.Index = Segregation.Index.1)

#head(minnesota)
```

```{r}
#Remove the first row from each dataset before concatenating 
#because it contains statewide data instead of a specific county
all_states <- rbind(alabama[-1,], texas[-1,], nc[-1,], ny[-1,], 
                    washington[-1,], colorado[-1,], minnesota[-1,]) 
#all_states[sample(nrow(all_states), 10), ]
```

```{r}
all_states_final <- all_states |>
  mutate(
    Region = factor(case_when(
    State == 'Texas' ~ 'West South Central', 
    State == 'Alabama' ~ 'East South Central',
    State == 'North Carolina' ~ 'South Atlantic',
    State == 'New York' ~ 'Middle Atlantic',
    State == 'Washington' ~ 'Pacific',
    State == 'Colorado' ~ 'Mountain',
    State == 'Minnesota' ~ 'West North Central',
    TRUE ~ State #this says to keep all other values the same
  )), School.Funding.Cat = factor(case_when(
    School.Funding.Adequacy < 0 ~ 'Inadequate', 
    School.Funding.Adequacy > 0  ~ 'Adequate',
  TRUE ~ NA
  ), levels=c('Inadequate', 'Adequate'), labels=c(0, 1)))

```

```{r}
prop_tax <- read.csv('https://github.com/wujenny214/F24_STATS_FINAL/raw/refs/heads/main/county_data/acs_proptax.csv')
```

```{r}

merged_df <- merge(all_states_final, prop_tax, by = "FIPS", 
              all.x = TRUE, all.y = TRUE)

#merged_df[sample(nrow(all_states_final), 10), ]
#colSums(is.na(final_df))
```

```{r}
final_df <- merged_df |> 
  mutate(
    Median.Prop.Tax = as.numeric(med_re_.taxes_tot))
final_df = subset(final_df, select = -c(med_re_.taxes_tot, geo_id, county_name, state_name) )

```

**Provide a \`glimpse():**

```{r}
glimpse(final_df)
```

**Exploratory Plots:** Q1 Outcome Variable (Life Expectancy):

```{r plots-1, warning=FALSE}
ggplot(final_df, aes(x = Life.Expectancy)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue") +
  facet_wrap(~ Region) +
  labs(title = "Life Expectancy Distribution", x = "Life Expectancy", y = "Count")
```

Q1 Relationship of Interest:

```{r plots-2, warning=FALSE}
plot1 <- ggplot(final_df, aes(x = Residential.Segregation.Index, y = Life.Expectancy)) +
  geom_point(color='purple') +
  labs(x = "Residential Segregation", y = "Life Expectancy")+ 
  theme(plot.margin = margin(t = 20, r = 30, b = 20, l = 10),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8))

plot2 <- ggplot(final_df, aes(x = Percent.Limited.Access.Healthy.Foods
, y = Life.Expectancy)) +
  geom_point(color = "green") +
  labs( x = "% Population With Limited Healthy Food Access") +
  theme(plot.margin = margin(t = 20, r = 20, b = 20, l = 20),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8))

plot3 <- ggplot(final_df, aes(x = Percent.Uninsured.Adults, y = Life.Expectancy)) +
  geom_point(color = "blue") +
  labs(x = "% Adult Population Without Health Insurance", y = "Life Expectancy")+ 
  theme(plot.margin = margin(t = 20, r = 20, b = 20, l = 20),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8))

plot1 + plot2 + plot3 + plot_layout(ncol = 2, nrow=2) + 
  plot_annotation(title = "Relationships Between Predictors and 
                  Life Expectancy Outcome",
                  theme = theme(
      plot.title = element_text(hjust=0.5)))
```

Q2 Outcome Variable (School Funding Adequacy):

```{r}
ggplot(final_df, aes(x = State, fill=School.Funding.Cat)) + 
  geom_bar() + labs(x="State", y="Count of Counties", 
  fill='School Funding Adequacy', title = "School Funding Adequacy 
  in Seven US States") + theme(axis.text.x = 
  element_text(angle = 45, vjust = 1, hjust=1)) +
  scale_fill_discrete(labels=c('Inadequate Funding', 
  'Adequate Funding', 'No Data Available'))
```

Q2 Relationship of Interest:

```{r plots-4, warning=FALSE}
ggpairs(final_df, columns = c("Residential.Segregation.Index", 
                              "Median.Household.Income",
                              "Median.Prop.Tax"), 
        aes(color = School.Funding.Cat)) + 
        labs(title = "Pairwise Plots of Predictors Colored by 
             School Funding Adequacy",
              x = "Predictor 1",
              y = "Predictor 2",
              color = "School Funding Adequacy") +
         theme(plot.title = element_text(size=15, hjust=0.5), 
               strip.text.x = element_text(size = 5),
               strip.text.y = element_text(size = 4))


```

The above figure is a pairwise scatterplot for each pair of predictor
variables (residential segregation, property tax, and household income),
with the points being colored by the school funding adequacy outcome.
Along the diagonal are histograms showing the distribution of each
individual predictor, separated by each level of the school funding
adequacy outcome variable (red = 0, or inadequate funding; blue = 1, or
adequate funding; gray = NA values). The upper half shows the
correlation coefficient between each pair of predictors, and also the
specific correlation coefficients when the data is separated out by each
level of the outcome.

# Dataset 2

**Data source:**

**Brief description:**

**Research question 1:**

-   Outcome variable (include the name/description and type of
    variable):

**Research question 2:**

-   Outcome variable (include the name/description and type of
    variable):

**Load the data and provide a `glimpse()`**:

```{r data-2, warning=FALSE}

```

**Exploratory Plots:**

```{r plots-5}

```

# 

# Dataset 3 (optional)

**Data source:**

**Brief description:**

**Research question 1:**

-   Outcome variable (include the name/description and type of
    variable):

**Research question 2:**

-   Outcome variable (include the name/description and type of
    variable):

**Load the data and provide a `glimpse()`**:

```{r data-3, warning=FALSE}

```

**Exploratory Plots:**

```{r plots-3}

```

# 

# Team Charter

#### When will you meet as a team to work on the project components? Will these meetings be held in person or virtually?

We will meet virtually on Tuesday between 8 and 9 pm.

#### What is your group policy on missing team meetings (e.g., how much advance notice should be provided)?

If a team member will be missing a meeting, they should provide around
10-12 hours of advance notice (the morning of).

#### How will your team communicate (email, Slack, text messages)? What is your policy on appropriate response time (within a certain number of hours? Nights/weekends?)?

We will be using WhatsApp primarily for communication, with Slack as our
secondary chat. We will send Zoom invites via email to reserve our
weekly meeting time (Tuesdays 8-9 pm). Ideally, team members should
respond to or acknowledge messages within 1-3 hours on weekdays and 12
hours on weekends/during the night.

#### 
